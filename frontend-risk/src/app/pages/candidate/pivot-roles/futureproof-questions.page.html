<section class="space-y-6 max-w-3xl mx-auto px-4">
  <header class="space-y-2">
    <p class="text-xs uppercase tracking-wide text-slate-400">Küsimused</p>
    <h1 class="text-2xl font-bold text-slate-50">Selgitavad küsimused</h1>
    <p class="text-sm text-slate-400">
      Vastused täpsustavad sinu valmisoleku hinnangut. Iga vahelejäänud küsimus vähendab kindlustunnet.
    </p>
  </header>

  <div *ngIf="loadingStart || loadingQuestion" class="rounded-2xl border border-slate-800 bg-slate-900/80 p-5">
    <div class="flex items-center gap-3 text-sm text-slate-300">
      <span class="h-4 w-4 animate-spin rounded-full border-2 border-slate-700 border-t-emerald-400"></span>
      Laen küsimust...
    </div>
  </div>

  <div *ngIf="error" class="rounded-2xl border border-rose-500/40 bg-rose-950/50 p-4 text-sm text-rose-100">
    <div class="flex items-center justify-between">
      <p>{{ error }}</p>
      <button
        type="button"
        class="rounded-lg border border-rose-400 px-3 py-1 text-xs font-semibold text-rose-100 hover:border-rose-300"
        (click)="loadNextQuestion()"
      >
        Proovi uuesti
      </button>
    </div>
  </div>

  <div
    *ngIf="!loadingQuestion && !loadingStart && !error && question"
    class="rounded-2xl border border-slate-800 bg-slate-900/80 p-5 shadow-lg"
  >
    <div class="flex items-center justify-between text-xs text-slate-400">
      <span>Küsimus {{ questionIndex }} / {{ totalQuestions }}</span>
      <span>Vahelejätmine vähendab kindlustunnet</span>
    </div>
    <div class="mt-3 rounded-xl border border-slate-800 bg-slate-950/60 p-3 text-sm text-slate-200">
      <p class="font-medium text-slate-100">
        Need vastused aitavad meil hinnata sinu kohanemisvõimet, õppimistahet ja koostööstiili. See tõstab analüüsi täpsust.
      </p>
      <p class="mt-1 text-xs text-slate-400">Võid ka vahele jätta, aga see vähendab confidence’i.</p>
    </div>
    <div class="mt-3 space-y-2">
      <p class="text-sm font-semibold text-emerald-200">{{ question.title || 'Küsimus' }}</p>
      <p class="text-base text-slate-100">{{ question.text }}</p>
    </div>

    <div class="mt-4">
      <label class="text-sm text-slate-300">Sinu vastus</label>
      <textarea
        [(ngModel)]="answerText"
        rows="4"
        class="mt-2 w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-emerald-400 focus:outline-none"
        placeholder="Kirjelda lühidalt (võid lisada näiteid ja mõõdikuid)."
      ></textarea>
    </div>

    <div class="mt-4 flex flex-wrap gap-3">
      <button
        type="button"
        class="inline-flex items-center gap-2 rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-slate-900 shadow hover:bg-emerald-400 disabled:opacity-70"
        (click)="submitAnswer()"
        [disabled]="submitting || !answerText.trim()"
      >
        <span *ngIf="!submitting">Saada vastus</span>
        <span *ngIf="submitting" class="flex items-center gap-2">
          <span class="h-3 w-3 animate-spin rounded-full border-2 border-emerald-200 border-t-emerald-700"></span>
          Töötlen...
        </span>
      </button>

      <button
        type="button"
        class="inline-flex items-center gap-2 rounded-lg border border-slate-700 px-4 py-2 text-sm font-semibold text-slate-100 hover:border-emerald-400 hover:text-emerald-200 disabled:opacity-70"
        (click)="skipQuestion()"
        [disabled]="submitting"
      >
        Jäta vahele (vähendab kindlustunnet)
      </button>
    </div>
  </div>

  <div
    *ngIf="!loadingQuestion && !loadingStart && !error && !question && questionIndex >= totalQuestions"
    class="rounded-2xl border border-slate-800 bg-slate-900/80 p-4 text-sm text-slate-300"
  >
    <p>Kõik küsimused on vastatud. Suunan analüüsi...</p>
  </div>
</section>

